
<head>
    <meta charset="utf-8">

    <title>How to install Rancher on RancherOS</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="../../favicon.ico">

    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="BLOGS @ RAMSADA.io">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How to install Rancher on RancherOS">
    <meta property="og:description" content="In this guide, I am going to cover how to install Kubernetes cluster on single node using Rancher on RancherOS as Virtual Machine.KubernetesKubernetes is an open-source container-orchestration system for automating deployment, scaling and management of containerized applications. It was originally designed by Google and is now maintained by the">
    <meta property="og:url" content="http://localhost:2368/how-to-install-rancher-on-rancher-os/">
    <meta property="og:image" content="https://images.unsplash.com/photo-1521583621977-c63c261f3054?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=49b1548d6a25af342d4132951d44abcb">
    <meta property="article:published_time" content="2018-10-03T00:47:57.000Z">
    <meta property="article:modified_time" content="2018-10-03T09:35:14.000Z">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How to install Rancher on RancherOS">
    <meta name="twitter:description" content="In this guide, I am going to cover how to install Kubernetes cluster on single node using Rancher on RancherOS as Virtual Machine.KubernetesKubernetes is an open-source container-orchestration system for automating deployment, scaling and management of containerized applications. It was originally designed by Google and is now maintained by the">
    <meta name="twitter:url" content="http://localhost:2368/how-to-install-rancher-on-rancher-os/">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1521583621977-c63c261f3054?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=49b1548d6a25af342d4132951d44abcb">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Najar Ramsada">
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="720">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "BLOGS @ RAMSADA.io",
        "logo": "https://casper.ghost.org/v1.0.0/images/ghost-logo.svg"
    },
    "author": {
        "@type": "Person",
        "name": "Najar Ramsada",
        "url": "http://localhost:2368/author/najar/",
        "sameAs": []
    },
    "headline": "How to install Rancher on RancherOS",
    "url": "http://localhost:2368/how-to-install-rancher-on-rancher-os/",
    "datePublished": "2018-10-03T00:47:57.000Z",
    "dateModified": "2018-10-03T09:35:14.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1521583621977-c63c261f3054?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max&ixid=eyJhcHBfaWQiOjExNzczfQ&s=49b1548d6a25af342d4132951d44abcb",
        "width": 1080,
        "height": 720
    },
    "description": "In this guide, I am going to cover how to install Kubernetes cluster on single node using Rancher on RancherOS as Virtual Machine.KubernetesKubernetes is an open-source container-orchestration system for automating deployment, scaling and management of containerized applications. It was originally designed by Google and is now maintained by the",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.1">
    <link rel="alternate" type="application/rss+xml" title="BLOGS @ RAMSADA.io" href="../../rss/index.html">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="../../">BLOGS @ RAMSADA.io</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">How to install single node Kubernetes cluster using Rancher on RancherOS</h1>
                <section class="post-meta">
                    <p class="author">by <a href="../../author/najar/">Najar Ramsada</a></p>
                    <time class="post-date" datetime="2018-10-03">2018-10-03</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://images.unsplash.com/photo-1521583621977-c63c261f3054?ixlib=rb-0.3.5&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=1080&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ&amp;s=49b1548d6a25af342d4132951d44abcb" width="600" height="400" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>In this guide, I am going to cover how to install Kubernetes cluster on single node using Rancher on RancherOS as Virtual Machine.</p><figure class="kg-card kg-image-card"></figure><h2 id="kubernetes">Kubernetes</h2><p><em>Kubernetes is an open-source container-orchestration system for automating deployment, scaling and management of containerized applications. It was originally designed by Google and is now maintained by the Cloud Native Computing Foundation.</em></p><h2 id="rancheros">RancherOS</h2><p><em><strong>RancherOS</strong> is the smallest, easiest way to run Docker in production. Everything in <strong>RancherOS</strong> is a container managed by Docker. This includes system services such as udev and syslog . Because it only includes the services necessary to run Docker, <strong>RancherOS</strong> is dramatically smaller than most traditional <strong>operating systems</strong>.</em></p><h2 id="rancher">Rancher</h2><p><em><strong>Rancher</strong> is deployed as a set of Docker containers. Running <strong>Rancher</strong> is as simple as launching two containers. One container as the management <strong>server</strong> and another container on a node as an agent. <strong>Rancher Server</strong> - Single Container (non-HA) <strong>Rancher Server</strong> - Single Container (non-HA) - External database.</em></p><h2 id="install-rancheros-as-a-virtual-machine">Install RancherOS as a Virtual Machine</h2><p>Download latest release of Rancher OS from <a href="https://github.com/rancher/os/releases/latest">Rancher download page on github</a>.</p><p><a href="https://github.com/rancher/os/releases/latest">https://github.com/rancher/os/releases/latest</a></p><p>Create a new Virtual Machine using typical settings and choose the downloaded rancher ISO as an installer disk. Make sure you select Linux (Other linux 4.x or later kernal 64bit) as the guest operating system.</p><p>		- 2 CPU/4-8GB RAM/40GB HDD</p><figure class="kg-card kg-image-card"></figure><figure class="kg-card kg-image-card"></figure><p>Start the VM and boot from the ISO, once the VM is up, we are going to setup a cloud-config.yml file to customise our RancherOS install. Follow below commands to customise and install RancherOS.</p><p>Open VM remote console and login as root (Rancher ISO auto logs you in as rancher user).</p><figure class="kg-card kg-image-card"></figure><p>login as root</p><pre><code>rancher@rancher:~$ sudo /bin/bash</code></pre>
<p>change password for rancher user</p><pre><code>rancher@rancher:~$ passwd rancher</code></pre>
<figure class="kg-card kg-image-card"></figure><p>ssh into Rancher VM from your desktop</p><pre><code>$ ssh rancher@&lt;IP_ADDRESS of rancher VM&gt;
</code></pre>
<p>create a cloud-config.yml file, this is required at the least for adding ssh keys</p><pre><code>vi cloud-config.yml</code></pre>
<p>Insert the following in cloud-config.yml file. </p><pre><code>#cloud-config
# ssh keys for access
ssh_authorized_keys:
  - &lt;your ssh keys here&gt;

# rancherOS hostname
hostname: &lt;hostname&gt;

# rancher-network settings
rancher:
  network:
    interfaces:
      eth0:
        dhcp: true</code></pre>
<figure class="kg-card kg-image-card"></figure><p>Save the file and begin the installation.</p><pre><code>sudo ros install -c cloud-config.yml -d /dev/sda</code></pre>
<p>Once the installation is finished, reboot the VM. RancherOS VM is now ready, you can login using rancher user and your ssh keys.</p><p>This is where you can now run any docker containers on this VM. You can stop here or take it forward and install Rancher and configure Kubernetes cluster for docker swarm mode.</p><h2 id="install-rancher-on-rancheros">Install Rancher on RancherOS</h2><p>Rancher runs as a docker container on RancherOS. All you have to do is simply run the container as below.</p><pre><code>docker run -d --restart=unless-stopped -p 8080:80 -p 8443:443 -v rancher:/var/lib/rancher rancher/rancher
</code></pre>
<blockquote>
<p>Map port 80 to 8080 and 443 to 8443. This is required if you plan to use more than one node in cluster as the ingress proxy will need to use default port 80 and 443.</p>
</blockquote>
<pre><code>-p 8080:80 -p 8443:443
</code></pre>
<blockquote>
<p>Use a persitent volume to retain the configuration for Rancher</p>
</blockquote>
<pre><code>-v rancher:/var/lib/rancher
</code></pre>
<p>Give it a minute or so and open up a web browser and point it to IP address of your RancherOS VM and port 8080. e.g. http://192.168.1.18:8080/</p><p>Create a password for Admin user and URL for Rancher.</p><p>Next you will need to add a Kubernetes cluster before you can deploy any services or workloads.</p><figure class="kg-card kg-image-card"></figure><p>Select Add Cluster &gt; Custom &gt; Give it a name &gt; Next.</p><figure class="kg-card kg-image-card"></figure><p>Select all three node option. This will ensure our single node can function correctly.</p><figure class="kg-card kg-image-card"></figure><p>Copy the command displayed in step 2 and run the command in RancherOS VM to add that VM as Node in the Kubernetes cluster.</p><p>Give it a minute or so and you will see "1 new node has registered".</p><figure class="kg-card kg-image-card"></figure><p>You will see this node in provisioning state.</p><figure class="kg-card kg-image-card"></figure><p>After minute or so, this node will be in Active state.</p><figure class="kg-card kg-image-card"></figure><p>Your Kubernetes cluster is now ready to use.</p><figure class="kg-card kg-image-card"></figure><p>That's it. You now have a Kubernetes cluster running on single VM. You can add more nodes as same as above.</p><p>Go ahead and download Kubeconfig file or launch the Kubectl from GUI or just deploy the apps, services from Rancher GUI.</p>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="../../">BLOGS @ RAMSADA.io</a> © 2018</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
